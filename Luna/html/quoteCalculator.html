<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quote Calculator - Luna</title>
  <link rel="stylesheet" href="../css/main.css">
</head>
<body>

  <div class="calculator-header">
    <div class="header-left">
      <img class="extensionIcon" src="../icons/logo.png" alt="Luna Icon">
      <h1 id="extensionTitle">Luna</h1>
    </div>
    <a href="../html/mainMenu.html?fromBack=true" class="back-button" title="Back to Main Menu">‚Üê Back</a>
  </div>

  <div id="quoteCalculatorPage" class="page-container">

    <div class="card" id="card-quote-info">
      <div class="card-header">
        <span class="card-header-title">Name & Invoice Data</span>
        <div class="card-header-actions">
          <button class="collapse-toggle" title="Toggle Section">‚ñº</button>
          <div class="help-icon">?
            <span class="tooltip">Enter the customer's information and key pricing details. The MSRP total should not include any discounts or integrations costs.</span>
          </div>
        </div>
      </div>
      <div class="card-content">
        <div class="input-group">
          <label for="companyNameInput">Company Name:</label>
          <input type="text" id="companyNameInput">
        </div>
        <div id="erpLinkGroup" class="input-group hidden advanced-input">
          <label for="erpLinkInput">ERP Link:</label>
          <input type="text" id="erpLinkInput">
        </div>
        <div class="input-group">
          <label for="lastYearPrice">Last Year Price:</label>
          <input type="text" id="lastYearPrice" inputmode="decimal" placeholder="$0.00">
        </div>
        <div class="input-group">
          <label for="msrpTotal">MSRP Total (No Discounts & No Integrations Cost):</label>
          <input type="text" id="msrpTotal" inputmode="decimal" placeholder="$0.00">
        </div>
      </div>
    </div>

    <div class="card" id="card-quote-options">
      <div class="card-header">
        <span class="card-header-title">Integrations</span>
        <div class="card-header-actions">
          <button class="collapse-toggle" title="Toggle Section">‚ñº</button>
          <div class="help-icon">?
            <span class="tooltip">Select whether the customer requires integrations. The 'Increase' option is pre-selected for standard price adjustments.</span>
          </div>
        </div>
      </div>
      <div class="card-content">
        <div class="integrations-section">
          <label>Integrations?</label>
          <div class="integration-buttons">
            <button id="integrationsYes" class="integration-button" data-value="yes">Yes</button>
            <button id="integrationsNo" class="integration-button selected" data-value="no">No</button>
          </div>
        </div>
        <div class="discount-increase-section hidden">
          <label>Discount or Increase?</label>
          <div class="discount-increase-buttons">
            <button id="discountBtn" class="integration-button" data-value="discount" disabled title="Discount functionality coming soon!">Discount (disabled)</button>
            <button id="increaseBtn" class="integration-button selected" data-value="increase">Increase</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="card" id="card-quote-calculation">
      <div class="card-header">
        <span class="card-header-title">Calculated Values</span>
        <div class="card-header-actions">
          <button class="collapse-toggle" title="Toggle Section">‚ñº</button>
          <div class="help-icon">?
            <span class="tooltip">
                Enter the desired price increase percentage. The calculator will determine the final price and the necessary ERP discount to achieve it.<br><br>
                <b>ERP Discount Formula:</b> ( [New Price] / [Adjusted MSRP] ) - 1
            </span>
          </div>
        </div>
      </div>
      <div class="card-content">
        <div id="increaseFields" class="conditional-fields">
          <div class="input-group">
            <label for="increasePercentage">Increase Percentage (%):</label>
            <input type="text" id="increasePercentage" value="5.00%" min="0" max="1000" inputmode="decimal" placeholder="5.00%">
          </div>
          <div id="integrationsPercentageDisplay" class="display-group advanced-display hidden">
            <label>Integrations %<span class="advanced-tag">(ADVANCED)</span>:</label>
            <div class="display-box" id="integrationsPercentageValue">20.00%</div>
          </div>
          <div id="priceChangeValueDisplay" class="display-group advanced-display hidden">
            <label>Price Change<span class="advanced-tag">(ADVANCED)</span>:</label>
            <div class="display-box" id="priceChangeValueValue">$0.00</div>
          </div>
          <div id="integrationsCostDisplay" class="display-group hidden">
            <label>Integrations Cost:</label>
            <div class="display-box" id="integrationsCostValue">$0.00</div>
          </div>
          <div id="discountForErpDisplay" class="display-group hidden">
            <label>Discount for ERP:</label>
            <div class="display-box-with-button">
                <span id="discountForErpValue">0.00%</span>
                <button id="copyErpDiscountBtn" class="action-button-inside" title="Copy Percentage">üìã</button>
            </div>
          </div>
          <div id="totalEndPriceDisplay" class="display-group hidden">
            <label>Total End Price:</label>
            <div class="display-box" id="totalEndPriceValue">$0.00</div>
          </div>
        </div>
        <div class="input-group">
          <label for="notesInput">Notes:</label>
          <textarea id="notesInput" rows="4"></textarea>
        </div>
      </div>
    </div>

  </div>

  <!-- Calculator Footer Bar -->
  <div id="calculatorFooter" class="calculator-footer-bar">
    <button id="clearAllBtn" class="footer-button clear-button">üóëÔ∏è Clear All</button>
    <button id="completeBtn" class="footer-button complete-button">üíæ Complete</button>
  </div>

  <script type="module" src="../js/quoteCalculator.js"></script>
  <script type="module" src="../js/utils.js"></script>
</body>
</html>